# GMS2 UE4 Space Rocks


<!-- OVERVIEW -->
This tutorial is intended for those wanting an introduction to <i>GameMaker Studio 2</i> using their scrpting language <i>GML</i>. This assumes no prior knowledge of the software or scripting. 

This is the start of creating a **Asteroids** 'like' video game.  It will be a simpler version of the original introducing basic game design and development concepts.

* Tested on GameMake Studio2.3.5.589
* [GitHub Account](https://github.com) (free)
* [GitHub Desktop](https://desktop.github.com)

<br>


<!-- TOC -->
## Table of Contents

<kbd></kbd> &nbsp;&nbsp; [Setting Up](setting-up/README.md#user-content-setting-up) <br>
<kbd></kbd> &nbsp;&nbsp; [The Spaceship I](spaceship-i/README.md#user-content-the-spaceship-i) <br>
<kbd></kbd> &nbsp;&nbsp; [The Spaceship II](spaceship-ii/README.md#user-content-the-spaceship-ii) <br>
<kbd></kbd> &nbsp;&nbsp; [Shooting](shooting/README.md#user-content-shooting) <br>
<kbd></kbd> &nbsp;&nbsp; [Asteroids I](asteroids-i/README.md#user-content-asteroids-i) <br>
<kbd></kbd> &nbsp;&nbsp; [Asteroids II](asteroids-ii/README.md#user-content-asteroids-ii) <br>
<kbd></kbd> &nbsp;&nbsp; [Spawn Next Size Rock](next-size/README.md#user-content-spawn-next-size-rock) <br>
<kbd></kbd> &nbsp;&nbsp; [Front End](game-loop/README.md#user-content-front-end) <br>
<kbd></kbd> &nbsp;&nbsp; [Score](score/README.md#user-content-score) <br>
<kbd></kbd> &nbsp;&nbsp; [Lives, Winning and Losing](lives/README.md#user-content-lives-winning-and-losing) <br>
<kbd></kbd> &nbsp;&nbsp; [Launch Waves](waves/README.md#user-content-launch-waves) <br>
<kbd></kbd> &nbsp;&nbsp; [Audio](audio/README.md#user-content-audio) <br>

 

Extra walk through - add flame to back of ship
Extra walk through add time in room

<!-- LICENSE -->
## License
Distributed under the MIT License. See `LICENSE` for more information: [link](LICENSE).

## Introduction
This is based on [GMS2 First Look](https://github.com/maubanel/GMS2-First_Look) and is meant as a follow up/companion to **Space Rocks - GML Tutorial** which is a freely available tutorial at [YoYo Games Marketplace](https://marketplace.yoyogames.com/assets/7423/space-rocks-gml).  This will go into the development of a game from scratch.

In this tutorial:

* Creating art assets
* Space ship vehicle physics
* Shooting
* Animating obstacles
* Audio sound effects
* Add variables and comments to all scripts without changing functionality
* Add flame behind ship when accelerating
* Add ship explosion animation
* Change player death and end game timing
* Add friction and maximum speed
* Use timeline for spawning rocks and add custom spawning script
* Trigger waves either by time or by score

## Controls
* Left and Right arrow rotate the ship
* Up arrow accelerates
* Space bar shoots
* Enter starts game

## Game Design Concept
The infrastructure for the  following game design concept is introduced in this tutorial.


| Game Design Concept | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Escalation          | A positive feedback loop in which the game gets more difficult the closer the player gets to the goal.  This is often combined with risk/reward scenarios which allows for faster completion but with greater risk to the player. Escalation allows the designer to slow down better players by escalating the difficulty faster, slowing the  player's progression through the level.  This can be achieved through various means but common ones are speed (Pac Man ghosts speed up as level progresses), increase in number of enemies or objects you need to deal with (tetris has more falling shapes) or aggressiveness of the attack.  It is good to model in breaks so that there are peaks and rest periods in the level driving the player to completion.      |

## Programming Concepts
The following programming concepts are raised in GMS2-ExtendingSpaceRocks.yyp. Here are the new programming concepts that are introduced in this second walk through.

| Programming Concept                                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Example                                                                                                                                                                                                                                             |
|-----------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| switch statement                                    | It is a type of control statement that controls flow and acts like an if - else if - else statement.  The variable in parenthesis after the `switch` statement is used to control the flow of the statement.  If that variable matches a `case` then the code after it is run until it hits a `break;`.  Be careful, if the break is omited the next case will apply as well and can be the cause of hard to find bugs.A `default` case at the end can be added in the event that all other cases are false and acts as a default (like the final `else` in an if statement).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | switch (age) <br>{    <br>&#160;&#160;&#160;case (18): <br>&#160;&#160;&#160;draw_text(x,&#160;y,&#160;"adult");<br>&#160;&#160;&#160;break;<br><br><br>&#160;&#160;&#160;case(12):<br>&#160;&#160;&#160;draw_text(x,&#160;y,&#160;"twelve&#160;years&#160;old");<br>&#160;&#160;&#160;break;<br><br>&#160;&#160;&#160;case(5):<br>&#160;&#160;&#160;draw_text(x,&#160;y,&#160;"5&#160;years&#160;old");<br>&#160;&#160;&#160;break;<br>} |
| dot accessing game objects<br>(`obj_game.p1_score`) | There are multiple ways of accessing other game objects variables (not local variables with var keyword).  All variables in GMS2 are considered public and are accessible by other objects in the game.  For example we have an enemy object called `obj_enemy`.  The player needs to know where the enemies position is on screen so it can access its `x` and `y` value by calling them inside the `obj_player` object with `obj_enemy.x` and `obj_enemy.y`. This only works if there is only a single instance of obj_enemy in the game.  If there are multiple instances of this object this way of accessing it is unreliable as ultimately will go through all instances and end up with the value from the final instance that was loaded in the level. | <br>in&#160;`obj_player step`&#160;event<br><sub><sup>`direction=point_direction(x,y,obj_enemy.x,obj_enemy.y);`</sup></sub>                                                                                                                                                         |
| @string                                             | To preserve formatting when drawing strings in gamemaker you can use the special @"strings" to preserve spacing and line breaks.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `draw_text(x, y, @"Line 1,`<br>`this is line 2`,<br>`this is the final line 3.");`                                                                                                                                                     |
| Force                                               |  F⃗ = ma⃗.  Force equals mass times acceleration.  In this example we will use a mass of 1 so we can skip it from the formula.  Our force F⃗ vector is kept in the built in `speed` and `direction` variables.  Acceleration is a user variable called `acceleration` that is found in `obj_player`.    | `acceleration=.05;`                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                     |
| Friction                                            | We simplify friction by just reducing the magnitude of the speed by a small amount (smaller than acceleration or it would not move) every frame.     | `speed=speed-ship_friction;`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                     |
| Velocity                                            |  V⃗ = V⃗ + a⃗. A new velocity is calculated by adding the acceleration to the existing velocity              | `motion_add(image_angle,acceleration);`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                     |


## GameMaker Resources

On the right hand side of the game editor you have a list of all resources that can be added to the game.
GameMaker Resources. Here are the new GameMaker resources that are introduced in this second walk through.

| GameMaker Resources | Description                                                                                                                                                                                                                                                                                                                                                 |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Sounds              | GameMaker Studio 2 allows for `.wav` and `.mp3` files.  It is strongly recommended to use `.mp3` files for music or any long audio sequence due to its smaller size.                                                                                                                                                                                        |
| Scripts             | Scripts are away to simplify and shorten event based scripts (like step events in a game object).  This makes the code easier to maintain and can make it more reusable.  These scripts acts like functions in other programming languages and can take parameters and return values.                                                                       |
| Fonts               | This allows you to select a font that is already available on your computer to be added to the game. Please note that for the editor the font needs to be loaded in the computer already to show up.  So you need to make sure this font is installed on all computers that are working on the game.  A build of the game on its own will include the font. |

## GameMaker Events
GameMaker can only run scripts on given events. The below are the most common event types we use. Here are the new GameMaker events that are introduced in this second walk through.


| GameMaker Events | Description                                                                                                                                                                                                                                                                                                                                            |
|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Alarm            | This event is run when an alarm is set and it reaches it frame time.  If an `alarm[0] = room_speed` is set it will trigger the `alarm0` event in one second.  There are 12 alarm events on each object.                                                                                                                                                |
| Room Start       | Room start event is run only once as soon as a new room is loaded (including the first one). It can be found in the `other` menu item in `add event` menu.                                                                                                                                                                                             |
| Collision        | A collision is set between the calling object and another object class that it is colliding with.                                                                                                                                                                                                                                                      |
| Outside Room     | This script runs when an object leaves a room.  It is common to destroy the object when it leaves the game space.                                                                                                                                                                                                                                      |
| End Step         | Each event runs in a specific order. Sometimes we want to perform an operation or check when all the objects are processed and in their new position and rotation in the room.  Please note that the new location of an object set with 1`speed`, `direction`, `vspeed` or `hspeed` is done between the regular `step` event and the `end step` event. |                                                                  |
| Exit       | "Exit" simply ends the execution of the current script or event. This is similar to returning null in other programming languages |                                                                  |

"Exit" simply ends the execution of the current script or event. 

## Built in Object Variables

GameMaker objects all share common built in variables. Here are the ones that are important to this exercise. Here are the new Built-In Variables that are introduced in this second walk through.

| Built-In Object Variables | Description                                                                                                                                                                                                                                                                                                                              | Example                                |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
| alarm[n]                  | There are 12 alarms that can be set on an individual game object (alarm[0] through alarm[11]). This runs a an alarm script as a future event in game steps.  An alarm that is not set (not active) is set to `-1`.  When triggering an alarm it is important to make sure it is only triggered once, especially if it is in a step event. | `if(alarm[0]<0)`<br>`   alarm[0]=room_speed*2;` |
| score                     | This is a real number global variable that is accessible from any object.  There is only a single score so in a multiplayer game, you will need to create another variable. The default value is `0`.                                                                                                                                    | `score=100;`                           |
| lives                     | This is a real number global variable that is accessible from any object.  There is only a single health variable so in a multiplayer game you will need to create another variable. The default value is `0`.                                                                                                                           | `lives=5;`                             |
| image_alpha               | This is a real number that determines how opaque the sprite will be rendered.  It defaults to `1` which is completely opaque.  `.5` would be 50% transparent and 50% opaque and `0` would be 100% transparent, effectively invisible.                                                                                                    | `image_alpha=.75;`                     |
| image_index               | This is an integer that refers to which frame of a sprite the game is displaying.  The first frame in a sprite is `image_index` of `0`. Each subsequent sprite goes up by 1.                                                                                                                                                             | `image_index=0;`                       |
| sprite_index              | This refers to which sprite the game object embeds.  For a player animation you might need to change sprites for different directions of movement.  You assign the name of the sprite that you use.                                                                                                                                      | `sprite_index=spr_player_right;`       |

## GameMaker Constants
These are non changing variable names that cannot be changed. They show up in gamemaker as a red font.  Here are the new Game-Maker constants that are introduced in this second walk through.

| GameMaker Constants | Description              | Example                              |
|---------------------|--------------------------|--------------------------------------|
| c_lime              | Draw color of lime.      | `draw_set_color(c_lime);`            |
| c_red               | Draw color of red.       | `draw_set_color(c_red);`             |
| vk_space            | Spacebar on the keyboard | `if(keyboard_check(vk_space)){...;}` |

## GameMaker Built in Functions
These are the functions that GameMaker provides that we used in this exercise.  Here are the new GameMaker built in functions that are introduced in this second walk through.

| Built-In Functions                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Example                                                                                       |
|------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| draw_set_font(font)                                                                      | This function should be used in a draw event and sets the next font used.  Please not that this is not local to this object so it will also effect the font of the next objects draw calls.  So if you want it to return to another font you should do so at the end of the draw event.                                                                                                                                                                                                                                                                                                                                                       | `draw_set_font(fnt_reg);`                                                                     |
| draw_text_transformed_colour(x, y, string, xscale, yscale, angle, c1, c2, c3, c4, alpha) | This draws text at position `x`, `y` with a `string` in quotation marks ("example string").  If you want a font that is 100% to scale you would set `xscale` and `yscale` to `1`.  Setting them both to `.25` will make the text one quarter of its original size on both axis.  The `angle` argument sets the direction that the text is drawn in.  `0` is left to right, `90` would be straight up, `180` would be top to bottom.  `c1` through `c4` set the color for top left, top right, bottom right and bottom left.  Finally the `alpha` variable sets the opacity of the text with `1` as fully opaque and `0` as fully transparent. | `draw_text_transformed_colour(50, 75, "Multicolor String", 1, 1, -90, c1, c2, c3, c4, 1)` |
| audio_is_playing(sound)                                                                  | This function will check the given sound to see if it is currently playing.  It will return true if the sound is playing and false if it is not.  You can pass it the name of the sound file given in the editor.                                                                                                                                                                                                                                                                                                                                                                                                                             | `if sound_is_playing(snd_music){...;}`                                                         |
| audio_stop_sound(sound)                                                                  | This function will stop playing audio.  It is often combined with the above function that checks first to see if the sound file is playing.  You can pass it the name of the sound file given in the editor.                                                                                                                                                                                                                                                                                                                                                                                                                                  | `sound_stop_playing(snd_music);`                                                              |
| audio_play_sound(sound, priority, loop)                                                  | This function will play a `.wav` or `.mp3` file.  You can set the priority in case too many sounds are playing and the game cannot add another sound to the game, it will prioritize ones with lower numbers. If you want the audio to play only once you would set `loop` to `false`.                                                                                                                                                                                                                                                                                                                                                        | `audio_play_sound(snd_music, 1, true);`                                                       |
| room_goto(room)                                                                          | This function will leave the level you are currently in and load a new one.  You pass it the name of the room you created in the editor or dynamically in code.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | `room_goto(rm_lvl2);`                                                                         |
| instance_exists(object)                                                                  | This function returns `true` or `false` if at least one instance of a given object is in the level at the moment the function is called.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | `if (instance_exists(obj_player)){...;}`                                                      |
| keyboard_check_pressed(key)                                                              | This function returns `true` or `false` if a specific key passed as an argument is pressed.  A key has four states.  Not pressed, pressed when it is first pushed, held down, and released when it is released.  Use `keyboard_check(key)` for when you want to know if the button is held down and use this one to only get one event per button press.                                                                                                                                                                                                                                                                                      | `if(keyboard_check_pressed(vk_right)){...;}`                                                  |
| choose(val0, val1, val2... max_val)                                                      | This function will return a random single instance of all objects passed to it in this function.  It allows you to quickly randomize game assets where variety is needed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `draw_set_color(choose(c_white, c_red, c_orange));`                                           |
| irandom_range(min, max)                                                                  | This will return an integer (whole number) between and including the min and max value set.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `damage = irandom_range(5, 10);`                                                              |                                                                      |
| clamp(val, min, max)                                                                     | This function returns a real number where the `val` is clamped between the `min` and `max` value sent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `speed = clamp(speed, 0, 5);`                                                                 |
| instance_destroy(object)                                                                 | This function destroys the object or instance passed to the function as an argument.  If the argument is empty, then the sprite calling the function will be destroyed. Please note that objects that are not visible DOES NOT MEAN they are destroyed.  If objects go off screen they continue to exist until you destroy them with `instance_destroy()`.                                                                                                                                                                                                                                                                                    | `instance_destroy();`                                                                         |
| motion_add(direction, speed)                                                             | This function adds two vectors in the polar coordinate system (angle and magnitude). The `direction` argument is expecting degrees (`0` to `360`) and not radians.  The speed is set in pixels and should be a whole number. This adds the arguments to the current `speed` and `direction` that is set in the player variable.  It is equivalent of adding two velocity vectors together.                                                                                                                                                                                                                                                    | `motion_add(90, 5);`                                                                          |
| lengthdir_x(len, dir);                                                                   | This function converts from the polar coordinate system to the cartesian coordinate system.  It is passed an angle and magnitude and returns an real number relative to the current position of the object in the room on the `x` axis.                                                                                                                                                                                                                                                                                                                                                                                                       | `x = lengthdir_x(5, 45);`                                                                     |
| lengthdir_y(len, dir);                                                                   | This function converts from the polar coordinate system to the cartesian coordinate system.,It is passed an angle and magnitude and returns an real number relative to the current position of the object in the room on the `y` axis.                                                                                                                                                                                                                                                                                                                                                                                                        | `y = lengthdir_y(5, 45);`
| instance_create_layer(x, y, layer_id, obj)                                                                 | This function adds an instance of a game object to the room.  It is put in the `x` and `y` location in the level inside of `layer_id1`. This is the name of the room layer passed as a string (inside quotation marks).  The object is the name of the game object in the editor.                                                                                                                                                                                                                                                                                                                                                                                                        | `instance_create_layer(100, 200, "Instances", obj_bullet);`      |

## User Created Function
Here are new functions that were provided for you with this walk through.  

| User Created Functions                                                                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Example                                                                                       |
|------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| scr_spawn_asteroid(asteroid_sprite, x_pos, y_pos, speed_multiplier, angle)                                                                      | This function spawns an asteroid outside the room.  `asteroid_sprite` has to be `spr_asteroid_huge`, `spr_asteroid_small` or `spr_asteroid_med`. An error is thrown if another sprite is passed to this function. The `x_pos` and `y_pos` is a normalized value between `0` and `1`. `0` and `1` are just outside the room and a fraction inbetween positions it between the left and right side of the view (on `x_pos`) and between top and bottom view (`y_pos`).  If both numbers are fractional, it will throw an error as the rock needs to be spawned off screen to avoid it popping in. The `speed_multiplier` increases or decreases the base speed of the asteroid.  The `angle` determines what direction the asteroid is moving in.                                                                                                                                                                                                                                                                                                                                                       | `spr_spawn_asteroid (spr_asteroid_small, 0, .5, 1.5, 225);`    

## Algorithm(s)
Game Controller.  This is a singleton pattern where we have a game object that is usually set to `persistent` so that it exists from the very beginning to the very end of the game.  It should contain all the variables that are needed for reloading the game at the given point and state.  It usually keeps track of score and health and all other variables that matter to the game.





</p>
</details>
<details><summary>Dev Tips</summary>
make git m="add commit message"
</details>

